<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Notes</title>
	<style>
		textarea {
			width:97%;
			height:675px;
			border:none;
			outline: none;
			padding: 5px;
			font-size:16px;
			font-family:inherit;
			resize:none;
        	}
		.dvOptions {
			margin: 10px 0px 10px 0px;
		}
		img {
			width:100%;
		}
		.spnLabel {
			font-weight:bold;
			font-size:28px;
			padding:5px 5px 5px 5px;
			vertical-align:bottom;
		}
		.spnSpace {
			display:inline-block;
			width:83%;
		}
		::-webkit-scrollbar { 
        		display: none; 
		}
	</style>
	<script>
		var imgHeight = 750;
		var imgQuality = 0.8;
		function exportPicture() {
			var a = document.createElement("a");
			if(tb().value != "") {
				a.download = "note_" + dateStamp() + ".txt";
      				a.href = window.URL.createObjectURL(new Blob([tb().value], { type: "text/plain" }));
			} else {
				a.download = "IMG_" + dateStamp() + ".jpg";
				a.href = im().src;
			}
			a.innerHTML = "export";      			
			a.style.display = "none";
			a.onclick = function (e) { document.body.removeChild(e.target); };
			document.body.appendChild(a);
			a.click();
		}
		function importFile() {
			var fileReader = new FileReader();
		      	fileReader.onload = function(e) {
				if(fl().files[0].type == "image/jpeg") {
					tb().style.display = "none";
					im().style.display = "block";
					tb().value = "";
					var image = new Image();
					image.onload = function() {
						var cvs = document.createElement("canvas");
						var ctx = cvs.getContext("2d");
						var w = image.width;
						var h = image.height;
						w = imgHeight/h*w;
						h = imgHeight;
						cvs.width = w;
						cvs.height = h;
						ctx.drawImage(this, 0, 0, w, h);
						im().src = cvs.toDataURL("image/jpeg", imgQuality);
					};
					image.src = e.target.result;
				} else {
					im().src = "";
					im().style.display = "none";
					tb().style.display = "block";
					tb().value = e.target.result;
				}
			};
			fileReader.readAsDataURL(fl().files[0], "UTF-8");
		}
		function setSize() {
			tb().style.height = (window.innerHeight  > 600) ? "675px" : "415px";
		}
		function dateStamp() {
			var d = new Date();
			return d.getFullYear()    
				+ ('0' + (d.getMonth() + 1)).slice(-2)
				+ ('0' + d.getDate()).slice(-2)
				+ ('0' + d.getHours()).slice(-2)
				+ ('0' + d.getMinutes()).slice(-2)
				+ ('0' + d.getSeconds()).slice(-2);
        }
	function tb() { return document.getElementById("tbNote"); }
	function fl() { return document.getElementById("fileImport"); }
	function im() { return document.getElementById("img"); }
    </script>
</head>
<body onresize="setSize();">
	<div id="dvOptions" class="dvOptions">
		<span id="spnSettings" class="spnLabel" onclick="exportPicture();">=</span>
		<span class="spnSpace"></span>
		<span class="spnLabel" onclick="fl().click();">+</span>
		<input type="file" id="fileImport" onchange="importFile();" style="display:none;" />
	</div>
	<textarea id="tbNote"></textarea>
	<img id="img" />
</body>
</html>
